<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controle de Ativos de TI</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      background-color: #FFFFFF;
      color: #000000;
    }

    .dark-mode {
      background-color: #121212 !important;
      color: #FFFFFF !important;
    }

    .table thead {
      background-color: #085a89;
      color: white;
    }

    .btn-toggle-mode {
      position: absolute;
      top: 20px;
      right: 20px;
    }

    .filter-box {
      margin-bottom: 10px;
    }

    .rounded-input {
      border-radius: 0.5rem;
      padding: 0.5rem;
      border: 1px solid #ccc;
    }

    .logo {
      height: 50px;
    }

    .cards-container {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .info-card {
      background-color: #085a89;
      color: white;
      padding: 20px;
      border-radius: 10px;
      flex: 1;
      margin: 10px;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="container mt-5">
    <img src="Logo - TURP - Transporte (Fundo Transparente - Cor Branco).png" class="logo mb-4">
    <button onclick="toggleDarkMode()" class="btn btn-secondary btn-toggle-mode">Alternar Modo</button>

    <h1 class="text-center">Controle de Ativos de TI</h1>

    <div class="d-flex justify-content-between align-items-center mt-4 mb-2">
      <input type="text" id="filtro" class="rounded-input" placeholder="Filtrar itens...">
      <button class="btn btn-success" onclick="abrirModalNovoItem()">+ Novo Item</button>
    </div>

    <div class="cards-container">
      <div class="info-card">
        <h5>Total de Itens</h5>
        <p id="card-total">0</p>
      </div>
      <div class="info-card">
        <h5>Ativos</h5>
        <p id="card-ativos">0</p>
      </div>
      <div class="info-card">
        <h5>Inativos</h5>
        <p id="card-inativos">0</p>
      </div>
      <div class="info-card">
        <h5>Reservas</h5>
        <p id="card-reservas">0</p>
      </div>
    </div>

    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Nº de Série</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody id="tabela-corpo">
        <!-- Itens inseridos aparecerão aqui -->
      </tbody>
    </table>

    <button class="btn btn-primary mt-3" onclick="confirmarExportacao()">Exportar para Excel</button>
  </div>

  <!-- Modal de Novo Item -->
  <div class="modal" tabindex="-1" id="modalNovoItem">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Adicionar Novo Item</h5>
          <button type="button" class="btn-close" onclick="fecharModalNovoItem()"></button>
        </div>
        <div class="modal-body">
          <input id="novoNome" class="form-control mb-2" placeholder="Nome do Item">
          <input id="novoSerial" class="form-control mb-2" placeholder="Número de Série">
          <select id="novoStatus" class="form-control">
            <option value="ativo">Ativo</option>
            <option value="inativo">Inativo</option>
            <option value="reserva">Reserva</option>
          </select>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="fecharModalNovoItem()">Cancelar</button>
          <button class="btn btn-primary" onclick="adicionarItem()">Salvar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Confirmação -->
  <div class="modal" tabindex="-1" id="modalExportar">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirmação</h5>
        </div>
        <div class="modal-body">
          <p>Deseja exportar os dados para Excel?</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="fecharModalExportar()">Cancelar</button>
          <button class="btn btn-success" onclick="exportarParaExcel()">Confirmar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const corpoTabela = document.getElementById("tabela-corpo");
    const filtro = document.getElementById("filtro");
    const modalNovoItem = new bootstrap.Modal(document.getElementById('modalNovoItem'));
    const modalExportar = new bootstrap.Modal(document.getElementById('modalExportar'));

    let listaItens = [];

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
    }

    function atualizarCards() {
      document.getElementById("card-total").textContent = listaItens.length;
      document.getElementById("card-ativos").textContent = listaItens.filter(i => i.status === "ativo").length;
      document.getElementById("card-inativos").textContent = listaItens.filter(i => i.status === "inativo").length;
      document.getElementById("card-reservas").textContent = listaItens.filter(i => i.status === "reserva").length;
    }

    function renderizarTabela() {
      corpoTabela.innerHTML = "";
      const termo = filtro.value.toLowerCase();
      listaItens.filter(item => item.nome.toLowerCase().includes(termo))
        .forEach((item, index) => {
          const linha = `<tr>
            <td>${item.nome}</td>
            <td>${item.serial}</td>
            <td>${item.status}</td>
            <td>
              <button class='btn btn-sm btn-warning' onclick='editarItem(${index})'>Editar</button>
              <button class='btn btn-sm btn-danger' onclick='excluirItem(${index})'>Excluir</button>
            </td>
          </tr>`;
          corpoTabela.innerHTML += linha;
        });
      atualizarCards();
    }

    function abrirModalNovoItem() {
      document.getElementById("novoNome").value = "";
      document.getElementById("novoSerial").value = "";
      document.getElementById("novoStatus").value = "ativo";
      modalNovoItem.show();
    }

    function fecharModalNovoItem() {
      modalNovoItem.hide();
    }

    function adicionarItem() {
      const nome = document.getElementById("novoNome").value;
      const serial = document.getElementById("novoSerial").value;
      const status = document.getElementById("novoStatus").value;
      if (nome && serial) {
        listaItens.push({ nome, serial, status });
        renderizarTabela();
        fecharModalNovoItem();
      }
    }

    function excluirItem(index) {
      if (confirm("Deseja realmente excluir este item?")) {
        listaItens.splice(index, 1);
        renderizarTabela();
      }
    }

    function confirmarExportacao() {
      modalExportar.show();
    }

    function fecharModalExportar() {
      modalExportar.hide();
    }

    function exportarParaExcel() {
      const csv = ["Nome,Nº de Série,Status"];
      listaItens.forEach(item => {
        csv.push(`${item.nome},${item.serial},${item.status}`);
      });
      const blob = new Blob([csv.join("\n")], { type: "text/csv" });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "ativos-ti.csv";
      a.click();
      fecharModalExportar();
    }

    filtro.addEventListener("input", renderizarTabela);
  </script>
</body>

</html>
